<div class="header">
    <h1>Liste des ingrédients (Ajout- Modification- Suppression)</h1>
</div>
<h3>Cliquez sur le nom d'un ingrédient pour l'afficher ou le modifier. <br/> Cliquez sur les boutons pour en ajouter ou supprimer.</h3>
<a (click)="onClickRecette(recette._id)"><button class="retour">Retour</button></a>
<div class="ingredients">
    <div class="ingredient titre">
        <p>Nom / Modifier</p>
        <p>Quantite</p>
        <p>Unité</p>
        <p>Supprimer</p>
    </div>
    <div class="ingredient"*ngFor="let composant of composants">
        <p class="scale"><a title="modify" (click)="modify(composant)">{{composant.ingredient?.nomIngredient}}</a></p>
        <p>{{composant.quantiteValue * recette.portions!}}</p>
        <p>{{composant.unite}}</p>
        <button class="supprimer" (click)="deleteComposant(composant, recette._id)">supprimer</button>
    </div>
</div>
<div class="ajout">
    <button class="ajouter" (click)="addComposant()">Ajouter</button>
</div>
<div *ngIf="composant" class="modify-container">
    <form class="object-form" [formGroup]="updateform" (ngSubmit)="updateComposant(updateform.value)">
        <input type="hidden" formControlName="_id" ngModel="{{composant._id}}">
        <input class="object-form-text" placeholder="Nom ingrédient" formControlName="nomIngredient" ngModel="{{composant.ingredient?.nomIngredient}}">
        <span class="error" *ngIf="updateform.get('nomIngredient')!.hasError('required') && updateform.get('nomIngredient')!.touched">Le nom de l'ingrédient est requis</span>
        <input type="number" step="0.1" class="object-form-text" placeholder="Quantité" formControlName="quantiteValue" ngModel="{{composant.quantiteValue * recette.portions!}}">
        <span class="error" *ngIf="updateform.get('quantiteValue')!.hasError('required') && updateform.get('quantiteValue')!.touched">La quantité de l'ingrédient est requise</span>
        <mat-form-field appearance="fill" style="width: 480px; background-color:rgb(64, 185, 185); border: 2px solid rgb(2, 216, 216)">
            <mat-label>Unitées</mat-label>
            <mat-select name="unite" value="{{composant.unite}}" formControlName="unite" ngModel="{{composant.unite}}">
              <mat-option *ngFor="let unite of unites" [value]="unite.viewValue">{{unite.viewValue}}</mat-option>
            </mat-select>
          </mat-form-field>
        <span class="error" *ngIf="updateform.get('unite')!.hasError('required') && updateform.get('unite')!.touched">L'unité de l'ingrédient est requise</span>
        <div class="button-container">
            <button class="invalidButton" title="invalid form" *ngIf="updateform.invalid" [disabled]="updateform.invalid" type="submit">MODIFIER</button>
            <button class="validButton" title="modifier" *ngIf="updateform.valid" [disabled]="updateform.invalid" type="submit">MODIFIER</button>
            <a class="cancel" title="annuler" (click)="unmodify()">ANNULER</a>
        </div>
    </form>
</div>



